exports.id=801,exports.ids=[801],exports.modules={1349:(e,r,a)=>{Promise.resolve().then(a.bind(a,83748))},14501:(e,r,a)=>{Promise.resolve().then(a.bind(a,83222))},83222:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>R});var t=a(45512),s=a(79334),n=a(58009),i=a(28531),l=a.n(i),o=a(80574),c=a(78632),d=a(61075),u=a(64977),h=a(4269),f=a(70384),m=a(81813),x=a(44269),b=a(99905),v=a(52706),p=a(30722),g=a(76438),w=a(59462),y=a(87021),j=a(65242),N=a(63066);let k=[{href:"/dashboard/teacher",label:"Tableau de bord",icon:o.A},{href:"/dashboard/teacher/students",label:"\xc9l\xe8ves",icon:c.A},{href:"/dashboard/teacher/notes",label:"Saisie des notes",icon:d.A},{href:"/dashboard/teacher/classes",label:"Classes",icon:u.A},{href:"/dashboard/teacher/corrections",label:"Corrections PDF",icon:h.A}],C=[{href:"/dashboard/student",label:"Tableau de bord",icon:o.A},{href:"/dashboard/student/notes",label:"Mes notes",icon:d.A},{href:"/dashboard/student/corrections",label:"Corrections",icon:h.A}],A=[{href:"/dashboard/admin",label:"Administration",icon:f.A},{href:"/dashboard/teacher",label:"Tableau de bord",icon:o.A},{href:"/dashboard/teacher/students",label:"\xc9l\xe8ves",icon:c.A},{href:"/dashboard/teacher/notes",label:"Saisie des notes",icon:d.A},{href:"/dashboard/teacher/classes",label:"Classes",icon:u.A},{href:"/dashboard/teacher/corrections",label:"Corrections PDF",icon:h.A}];function E(){let e=(0,s.usePathname)(),{role:r,setRole:a,user:n,logout:i}=(0,j.A)(),{mobileOpen:o,setMobileOpen:c,collapsed:d,setCollapsed:u}=(0,N.c)(),h=function(e){switch(e){case"admin":return A;case"teacher":return k;default:return C}}(r);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,w.cn)("fixed inset-0 z-40 bg-black/50 backdrop-blur-sm lg:hidden",o?"block":"hidden"),onClick:()=>c(!1),"aria-hidden":!0}),(0,t.jsxs)("aside",{className:(0,w.cn)("fixed left-0 top-0 z-50 flex h-screen flex-col border-r border-[var(--sidebar-border)] bg-[var(--sidebar)] transition-all duration-300 ease-out","w-[280px] lg:w-[280px]",d&&"lg:w-[72px] lg:min-w-[72px]","lg:translate-x-0",o?"translate-x-0":"-translate-x-full"),children:[(0,t.jsxs)("div",{className:"flex h-16 shrink-0 items-center justify-between gap-2 border-b border-[var(--sidebar-border)] px-4",children:[(0,t.jsxs)(l(),{href:"teacher"===r||"admin"===r?"/dashboard/teacher":"/dashboard/student",className:"flex items-center gap-3 overflow-hidden",onClick:()=>c(!1),children:[(0,t.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-[var(--primary)] text-[var(--primary-foreground)]",children:(0,t.jsx)(m.A,{className:"h-5 w-5"})}),!d&&(0,t.jsx)("span",{className:"font-display text-lg font-semibold tracking-tight text-[var(--sidebar-foreground)]",children:"SVT Notes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 lg:flex",children:[(0,t.jsx)(y.$,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>c(!1),"aria-label":"Fermer le menu",children:(0,t.jsx)(x.A,{className:"h-5 w-5"})}),(0,t.jsx)(y.$,{variant:"ghost",size:"icon",className:"hidden lg:flex",onClick:()=>u(e=>!e),"aria-label":d?"Ouvrir la sidebar":"R\xe9duire la sidebar",children:d?(0,t.jsx)(b.A,{className:"h-5 w-5"}):(0,t.jsx)(v.A,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("nav",{className:"flex-1 space-y-1 overflow-y-auto p-3",children:h.map(r=>{let a=r.icon,s=["/dashboard/teacher","/dashboard/student","/dashboard/admin"].includes(r.href)?e===r.href:e===r.href||e.startsWith(r.href+"/");return(0,t.jsxs)(l(),{href:r.href,onClick:()=>c(!1),className:(0,w.cn)("flex items-center gap-3 rounded-xl px-3 py-2.5 text-sm font-medium transition-all duration-200","text-[var(--sidebar-foreground)]/90",s?"bg-[var(--primary)]/15 text-[var(--primary)] shadow-sm":"hover:bg-[var(--muted)]/80 hover:text-[var(--sidebar-foreground)]"),children:[(0,t.jsx)(a,{className:"h-5 w-5 shrink-0"}),!d&&(0,t.jsx)("span",{children:r.label})]},`${r.href}-${r.label}`)})}),(0,t.jsx)("div",{className:"border-t border-[var(--sidebar-border)] p-3",children:(0,t.jsxs)("div",{className:(0,w.cn)("space-y-2",d&&"flex flex-col items-center"),children:[(0,t.jsx)("p",{className:(0,w.cn)("text-xs text-[var(--muted-foreground)]",d&&"hidden"),children:"Connect\xe9 en tant que"}),(0,t.jsxs)("select",{value:r,onChange:e=>a(e.target.value),className:(0,w.cn)("w-full rounded-lg border border-[var(--border)] bg-[var(--muted)] px-3 py-2 text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]",d&&"w-10 px-1 py-1 text-center"),title:"Changer de r\xf4le",children:[(0,t.jsx)("option",{value:"student",children:"\xc9l\xe8ve"}),(0,t.jsx)("option",{value:"teacher",children:"Enseignant"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}),!d&&(0,t.jsx)("p",{className:"truncate text-xs text-[var(--muted-foreground)]",children:n.name}),(0,t.jsxs)(y.$,{variant:"ghost",size:"sm",className:(0,w.cn)("w-full justify-start gap-2 text-[var(--muted-foreground)]",d&&"w-10 justify-center px-0"),onClick:()=>i(),children:[(0,t.jsx)(p.A,{className:"h-4 w-4"}),!d&&(0,t.jsx)("span",{children:"D\xe9connexion"})]})]})})]})]})}function S(){let{setMobileOpen:e}=(0,N.c)();return(0,t.jsx)(y.$,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>e(!0),"aria-label":"Ouvrir le menu",children:(0,t.jsx)(g.A,{className:"h-5 w-5"})})}var $=a(16928),z=a(24849),P=a(80904);function M(){let{user:e,useSupabase:r}=(0,j.A)(),[a,s]=n.useState(!1),i=n.useRef(null),l="student"===e.role,o=r&&l&&!!e.id,{notifications:c,unreadCount:u,loading:h,markAsRead:f,markAllAsRead:m,refetch:x}=(0,P.E$)(o?e.id:null,!!o);return(n.useEffect(()=>{a&&x()},[a,x]),n.useEffect(()=>{if(!a)return;let e=e=>{i.current&&!i.current.contains(e.target)&&s(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[a]),o)?(0,t.jsxs)("div",{className:"relative",ref:i,children:[(0,t.jsxs)(y.$,{variant:"ghost",size:"icon",onClick:()=>s(e=>!e),className:"relative h-9 w-9 rounded-lg","aria-label":u>0?`${u} notification(s)`:"Notifications","aria-expanded":a,children:[(0,t.jsx)($.A,{className:"h-5 w-5"}),u>0&&(0,t.jsx)("span",{className:"absolute -right-0.5 -top-0.5 flex h-4 min-w-4 items-center justify-center rounded-full bg-[var(--primary)] px-1 text-[10px] font-bold text-[var(--primary-foreground)]",children:u>99?"99+":u})]}),a&&(0,t.jsxs)("div",{className:"absolute right-0 top-full z-50 mt-2 w-[320px] max-w-[calc(100vw-2rem)] overflow-hidden rounded-xl border border-[var(--border)] bg-[var(--card)] shadow-xl",role:"dialog","aria-label":"Notifications",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-[var(--border)] px-4 py-3",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--foreground)]",children:"Notifications"}),u>0&&(0,t.jsxs)(y.$,{variant:"ghost",size:"sm",className:"h-8 text-xs text-[var(--primary)]",onClick:()=>m(),children:[(0,t.jsx)(z.A,{className:"mr-1 h-3 w-3"}),"Tout marquer lu"]})]}),(0,t.jsx)("div",{className:"max-h-[min(60vh,400px)] overflow-y-auto",children:h?(0,t.jsx)("div",{className:"px-4 py-8 text-center text-sm text-[var(--muted-foreground)]",children:"Chargementâ€¦"}):0===c.length?(0,t.jsx)("div",{className:"px-4 py-8 text-center text-sm text-[var(--muted-foreground)]",children:"Aucune notification"}):(0,t.jsx)("ul",{className:"divide-y divide-[var(--border)]/50",children:c.map(e=>(0,t.jsx)("li",{className:(0,w.cn)("px-4 py-3 transition-colors",!e.read&&"bg-[var(--primary)]/5"),children:(0,t.jsx)("button",{type:"button",className:"w-full text-left",onClick:()=>{f(e.id)},children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(d.A,{className:"mt-0.5 h-4 w-4 shrink-0 text-[var(--primary)]"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-[var(--foreground)]",children:e.title}),(0,t.jsx)("p",{className:"mt-0.5 text-xs text-[var(--muted-foreground)]",children:e.message}),(0,t.jsx)("p",{className:"mt-1 text-xs text-[var(--muted-foreground)]",children:new Date(e.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})})},e.id))})})]})]}):null}function R({children:e}){let{collapsed:r}=(0,N.c)(),{isLoggedIn:a,user:n,useSupabase:i}=(0,j.A)();return((0,s.useRouter)(),(0,s.usePathname)(),a)?(0,t.jsxs)("div",{className:"min-h-screen bg-[var(--background)]",children:[(0,t.jsx)(E,{}),(0,t.jsxs)("main",{className:(0,w.cn)("min-w-0 flex-1 transition-[padding] duration-300 ease-out",r?"lg:pl-[72px]":"lg:pl-[280px]"),children:[(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 shrink-0 items-center gap-2 border-b border-[var(--border)] bg-[var(--background)]/95 px-3 backdrop-blur supports-[backdrop-filter]:bg-[var(--background)]/80 sm:h-16 sm:px-4",children:[(0,t.jsx)(S,{}),(0,t.jsx)("div",{className:"flex-1 min-w-0"}),(0,t.jsx)(M,{})]}),(0,t.jsx)("div",{className:"min-w-0 overflow-x-hidden p-4 sm:p-6 lg:p-8",children:e})]})]}):(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,t.jsx)("p",{className:"text-[var(--muted-foreground)]",children:"Redirection..."})})}},87021:(e,r,a)=>{"use strict";a.d(r,{$:()=>c});var t=a(45512),s=a(58009),n=a(12705),i=a(21643),l=a(59462);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--primary)] focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--background)] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-[var(--primary)] text-[var(--primary-foreground)] shadow-sm hover:opacity-90",destructive:"bg-red-600 text-white shadow-sm hover:bg-red-700",outline:"border border-[var(--border)] bg-transparent hover:bg-[var(--muted)]",secondary:"bg-[var(--muted)] text-[var(--foreground)] hover:opacity-90",ghost:"hover:bg-[var(--muted)]",link:"text-[var(--primary)] underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-lg px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef(({className:e,variant:r,size:a,asChild:s=!1,...i},c)=>{let d=s?n.DX:"button";return(0,t.jsx)(d,{className:(0,l.cn)(o({variant:r,size:a,className:e})),ref:c,...i})});c.displayName="Button"},80904:(e,r,a)=>{"use strict";a.d(r,{E$:()=>u,HX:()=>d,bp:()=>c,gR:()=>l,uG:()=>o});var t=a(58009),s=a(24559),n=a(42445),i=a(65242);function l(){let{user:e,useSupabase:r}=(0,i.A)(),a=t.useMemo(()=>(0,s.A)(),[]),[l,o]=t.useState([]),[c,d]=t.useState(!0),[u,h]=t.useState(null),f=t.useCallback(async()=>{if(!r||!a){o([]),d(!1),h(null);return}d(!0),h(null);try{let e=await n.vK(a);o(e)}catch(e){h(e instanceof Error?e.message:"Erreur")}finally{d(!1)}},[r,a]);t.useEffect(()=>{f()},[f]);let m=t.useCallback(async t=>{if(r&&a){h(null);try{await n.KT(a,t.trim(),e.id),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[r,a,e.id,f]),x=t.useCallback(async(e,t,s)=>{if(r&&a){h(null);try{await n.eJ(a,e,t),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[r,a,f]),b=t.useCallback(async e=>{if(r&&a){h(null);try{await n.wt(a,e),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[r,a,f]);return{data:l,loading:c,error:u,refetch:f,addClass:m,updateClass:x,deleteClass:b}}function o(e){let r=t.useMemo(()=>(0,s.A)(),[]),{useSupabase:a}=(0,i.A)(),[l,o]=t.useState([]),[c,d]=t.useState(!1),[u,h]=t.useState(null),f=t.useCallback(async()=>{if(!e||!a||!r){o([]);return}d(!0),h(null);try{let a=await n.n0(r,e);o(a)}catch(e){h(e instanceof Error?e.message:"Erreur")}finally{d(!1)}},[e,a,r]);t.useEffect(()=>{f()},[f]);let m=t.useCallback(async t=>{if(e&&a&&r){h(null);try{await n.Yh(r,e,t),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[e,a,r,f]),x=t.useCallback(async t=>{if(e&&a&&r){h(null);try{await n.w4(r,e,t),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[e,a,r,f]);return{data:l,loading:c,error:u,refetch:f,addStudentToClass:m,removeStudentFromClass:x}}function c(e){let r=t.useMemo(()=>(0,s.A)(),[]),{useSupabase:a}=(0,i.A)(),[l,o]=t.useState([]),[c,d]=t.useState(!0),[u,h]=t.useState(null),f=t.useCallback(async()=>{if(!e){o([]),d(!1);return}if(!a||!r){o([]),d(!1),h(null);return}d(!0),h(null);try{let a=await n.us(r,e);o(a)}catch(e){h(e instanceof Error?e.message:"Erreur")}finally{d(!1)}},[e,a,r]);t.useEffect(()=>{f()},[f]);let m=t.useCallback(async t=>{if(e&&a&&r){h(null);try{await n.Sy(r,e,t),await f()}catch(e){throw h(e instanceof Error?e.message:"Erreur"),e}}},[e,a,r,f]);return{data:l,loading:c,error:u,refetch:f,setGrades:m}}function d(e){let r=t.useMemo(()=>(0,s.A)(),[]),{user:a,useSupabase:l}=(0,i.A)(),[o,c]=t.useState([]),[d,u]=t.useState(!0),[h,f]=t.useState(null),m=t.useCallback(async()=>{if(!l||!r){c([]),u(!1),f(null);return}u(!0),f(null);try{let a=await n.se(r,e);c(a)}catch(e){f(e instanceof Error?e.message:"Erreur")}finally{u(!1)}},[l,r,e?.classId]);t.useEffect(()=>{m()},[m]);let x=t.useCallback(async e=>{if(!l||!r)throw Error("Supabase requis");f(null);try{let t=await n.GH(r,{...e,uploadedBy:a.id});return await m(),t}catch(e){throw f(e instanceof Error?e.message:"Erreur"),e}},[l,r,a.id,m]),b=t.useCallback(async(e,a)=>{if(l&&r){f(null);try{if(a)try{await n.Gd(r,a)}catch(e){console.warn("Suppression du fichier Storage:",e)}await n.w$(r,e),await m()}catch(e){throw f(e instanceof Error?e.message:"Erreur"),e}}},[l,r,m]);return{data:o,loading:d,error:h,refetch:m,addCorrection:x,deleteCorrection:b}}function u(e,r){let a=t.useMemo(()=>(0,s.A)(),[]),[n,i]=t.useState([]),[l,o]=t.useState(!0),c=t.useCallback(async()=>{if(!r||!e||!a){i([]),o(!1);return}o(!0);try{let{data:r,error:t}=await a.from("notifications").select("id, title, message, read, created_at").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw Error(t.message);i(r??[])}catch{i([])}finally{o(!1)}},[r,e,a]);t.useEffect(()=>{c()},[c]);let d=t.useCallback(async e=>{a&&(await a.from("notifications").update({read:!0}).eq("id",e),i(r=>r.map(r=>r.id===e?{...r,read:!0}:r)))},[a]),u=t.useCallback(async()=>{a&&e&&(await a.from("notifications").update({read:!0}).eq("user_id",e),i(e=>e.map(e=>({...e,read:!0}))))},[a,e]),h=n.filter(e=>!e.read).length;return{notifications:n,unreadCount:h,loading:l,markAsRead:d,markAllAsRead:u,refetch:c}}},59462:(e,r,a)=>{"use strict";a.d(r,{cn:()=>n});var t=a(82281),s=a(94805);function n(...e){return(0,s.QP)((0,t.$)(e))}},83748:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>t});let t=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\SQMV0257\\\\svtProject\\\\app\\\\dashboard\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\SQMV0257\\svtProject\\app\\dashboard\\layout.tsx","default")}};