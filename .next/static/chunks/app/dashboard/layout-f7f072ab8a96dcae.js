(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{38867:(e,r,a)=>{Promise.resolve().then(a.bind(a,41448))},41448:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>_});var t=a(95155),s=a(76046),n=a(12115),l=a(48173),i=a.n(l),d=a(67401);let c=(0,d.A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var o=a(17548),h=a(14081),u=a(92823),x=a(93467);let m=(0,d.A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var f=a(27065),b=a(40767);let v=(0,d.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),p=(0,d.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),g=(0,d.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),y=(0,d.A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var j=a(29602),k=a(14085),N=a(6888),w=a(14766);let A=[{href:"/dashboard/teacher",label:"Tableau de bord",icon:c},{href:"/dashboard/teacher/students",label:"\xc9l\xe8ves",icon:o.A},{href:"/dashboard/teacher/notes",label:"Saisie des notes",icon:h.A},{href:"/dashboard/teacher/classes",label:"Classes",icon:u.A},{href:"/dashboard/teacher/corrections",label:"Corrections PDF",icon:x.A}],C=[{href:"/dashboard/student",label:"Tableau de bord",icon:c},{href:"/dashboard/student/notes",label:"Mes notes",icon:h.A},{href:"/dashboard/student/corrections",label:"Corrections",icon:x.A}],M=[{href:"/dashboard/admin",label:"Administration",icon:m},{href:"/dashboard/teacher",label:"Tableau de bord",icon:c},{href:"/dashboard/teacher/students",label:"\xc9l\xe8ves",icon:o.A},{href:"/dashboard/teacher/notes",label:"Saisie des notes",icon:h.A},{href:"/dashboard/teacher/classes",label:"Classes",icon:u.A},{href:"/dashboard/teacher/corrections",label:"Corrections PDF",icon:x.A}];function z(){let e=(0,s.usePathname)(),{role:r,setRole:a,user:n,logout:l}=(0,N.A)(),{mobileOpen:d,setMobileOpen:c,collapsed:o,setCollapsed:h}=(0,w.c)(),u=function(e){switch(e){case"admin":return M;case"teacher":return A;default:return C}}(r);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,j.cn)("fixed inset-0 z-40 bg-black/50 backdrop-blur-sm lg:hidden",d?"block":"hidden"),onClick:()=>c(!1),"aria-hidden":!0}),(0,t.jsxs)("aside",{className:(0,j.cn)("fixed left-0 top-0 z-50 flex h-screen flex-col border-r border-[var(--sidebar-border)] bg-[var(--sidebar)] transition-all duration-300 ease-out","w-[280px] lg:w-[280px]",o&&"lg:w-[72px] lg:min-w-[72px]","lg:translate-x-0",d?"translate-x-0":"-translate-x-full"),children:[(0,t.jsxs)("div",{className:"flex h-16 shrink-0 items-center justify-between gap-2 border-b border-[var(--sidebar-border)] px-4",children:[(0,t.jsxs)(i(),{href:"teacher"===r||"admin"===r?"/dashboard/teacher":"/dashboard/student",className:"flex items-center gap-3 overflow-hidden",onClick:()=>c(!1),children:[(0,t.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-[var(--primary)] text-[var(--primary-foreground)]",children:(0,t.jsx)(f.A,{className:"h-5 w-5"})}),!o&&(0,t.jsx)("span",{className:"font-display text-lg font-semibold tracking-tight text-[var(--sidebar-foreground)]",children:"SVT Notes"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 lg:flex",children:[(0,t.jsx)(k.$,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>c(!1),"aria-label":"Fermer le menu",children:(0,t.jsx)(b.A,{className:"h-5 w-5"})}),(0,t.jsx)(k.$,{variant:"ghost",size:"icon",className:"hidden lg:flex",onClick:()=>h(e=>!e),"aria-label":o?"Ouvrir la sidebar":"R\xe9duire la sidebar",children:o?(0,t.jsx)(v,{className:"h-5 w-5"}):(0,t.jsx)(p,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("nav",{className:"flex-1 space-y-1 overflow-y-auto p-3",children:u.map(r=>{let a=r.icon,s=["/dashboard/teacher","/dashboard/student","/dashboard/admin"].includes(r.href)?e===r.href:e===r.href||e.startsWith(r.href+"/");return(0,t.jsxs)(i(),{href:r.href,onClick:()=>c(!1),className:(0,j.cn)("flex items-center gap-3 rounded-xl px-3 py-2.5 text-sm font-medium transition-all duration-200","text-[var(--sidebar-foreground)]/90",s?"bg-[var(--primary)]/15 text-[var(--primary)] shadow-sm":"hover:bg-[var(--muted)]/80 hover:text-[var(--sidebar-foreground)]"),children:[(0,t.jsx)(a,{className:"h-5 w-5 shrink-0"}),!o&&(0,t.jsx)("span",{children:r.label})]},"".concat(r.href,"-").concat(r.label))})}),(0,t.jsx)("div",{className:"border-t border-[var(--sidebar-border)] p-3",children:(0,t.jsxs)("div",{className:(0,j.cn)("space-y-2",o&&"flex flex-col items-center"),children:[(0,t.jsx)("p",{className:(0,j.cn)("text-xs text-[var(--muted-foreground)]",o&&"hidden"),children:"Connect\xe9 en tant que"}),(0,t.jsxs)("select",{value:r,onChange:e=>a(e.target.value),className:(0,j.cn)("w-full rounded-lg border border-[var(--border)] bg-[var(--muted)] px-3 py-2 text-sm text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]",o&&"w-10 px-1 py-1 text-center"),title:"Changer de r\xf4le",children:[(0,t.jsx)("option",{value:"student",children:"\xc9l\xe8ve"}),(0,t.jsx)("option",{value:"teacher",children:"Enseignant"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}),!o&&(0,t.jsx)("p",{className:"truncate text-xs text-[var(--muted-foreground)]",children:n.name}),(0,t.jsxs)(k.$,{variant:"ghost",size:"sm",className:(0,j.cn)("w-full justify-start gap-2 text-[var(--muted-foreground)]",o&&"w-10 justify-center px-0"),onClick:()=>l(),children:[(0,t.jsx)(g,{className:"h-4 w-4"}),!o&&(0,t.jsx)("span",{children:"D\xe9connexion"})]})]})})]})]})}function P(){let{setMobileOpen:e}=(0,w.c)();return(0,t.jsx)(k.$,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>e(!0),"aria-label":"Ouvrir le menu",children:(0,t.jsx)(y,{className:"h-5 w-5"})})}let E=(0,d.A)("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),S=(0,d.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var R=a(37334);function L(){let{user:e,useSupabase:r}=(0,N.A)(),[a,s]=n.useState(!1),l=n.useRef(null),i="student"===e.role,d=r&&i&&!!e.id,{notifications:c,unreadCount:o,loading:u,markAsRead:x,markAllAsRead:m,refetch:f}=(0,R.E$)(d?e.id:null,!!d);return(n.useEffect(()=>{a&&f()},[a,f]),n.useEffect(()=>{if(!a)return;let e=e=>{l.current&&!l.current.contains(e.target)&&s(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[a]),d)?(0,t.jsxs)("div",{className:"relative",ref:l,children:[(0,t.jsxs)(k.$,{variant:"ghost",size:"icon",onClick:()=>s(e=>!e),className:"relative h-9 w-9 rounded-lg","aria-label":o>0?"".concat(o," notification(s)"):"Notifications","aria-expanded":a,children:[(0,t.jsx)(E,{className:"h-5 w-5"}),o>0&&(0,t.jsx)("span",{className:"absolute -right-0.5 -top-0.5 flex h-4 min-w-4 items-center justify-center rounded-full bg-[var(--primary)] px-1 text-[10px] font-bold text-[var(--primary-foreground)]",children:o>99?"99+":o})]}),a&&(0,t.jsxs)("div",{className:"absolute right-0 top-full z-50 mt-2 w-[320px] max-w-[calc(100vw-2rem)] overflow-hidden rounded-xl border border-[var(--border)] bg-[var(--card)] shadow-xl",role:"dialog","aria-label":"Notifications",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-[var(--border)] px-4 py-3",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--foreground)]",children:"Notifications"}),o>0&&(0,t.jsxs)(k.$,{variant:"ghost",size:"sm",className:"h-8 text-xs text-[var(--primary)]",onClick:()=>m(),children:[(0,t.jsx)(S,{className:"mr-1 h-3 w-3"}),"Tout marquer lu"]})]}),(0,t.jsx)("div",{className:"max-h-[min(60vh,400px)] overflow-y-auto",children:u?(0,t.jsx)("div",{className:"px-4 py-8 text-center text-sm text-[var(--muted-foreground)]",children:"Chargementâ€¦"}):0===c.length?(0,t.jsx)("div",{className:"px-4 py-8 text-center text-sm text-[var(--muted-foreground)]",children:"Aucune notification"}):(0,t.jsx)("ul",{className:"divide-y divide-[var(--border)]/50",children:c.map(e=>(0,t.jsx)("li",{className:(0,j.cn)("px-4 py-3 transition-colors",!e.read&&"bg-[var(--primary)]/5"),children:(0,t.jsx)("button",{type:"button",className:"w-full text-left",onClick:()=>{x(e.id)},children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(h.A,{className:"mt-0.5 h-4 w-4 shrink-0 text-[var(--primary)]"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-[var(--foreground)]",children:e.title}),(0,t.jsx)("p",{className:"mt-0.5 text-xs text-[var(--muted-foreground)]",children:e.message}),(0,t.jsx)("p",{className:"mt-1 text-xs text-[var(--muted-foreground)]",children:new Date(e.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})})},e.id))})})]})]}):null}let $="/dashboard/student/change-password";function _(e){let{children:r}=e,{collapsed:a}=(0,w.c)(),{isLoggedIn:l,user:i,useSupabase:d}=(0,N.A)(),c=(0,s.useRouter)(),o=(0,s.usePathname)();return((0,n.useEffect)(()=>{l||c.replace("/login")},[l,c]),(0,n.useEffect)(()=>{l&&d&&"student"===i.role&&i.mustChangePassword&&o!==$&&c.replace($)},[l,d,i.role,i.mustChangePassword,o,c]),l)?(0,t.jsxs)("div",{className:"min-h-screen bg-[var(--background)]",children:[(0,t.jsx)(z,{}),(0,t.jsxs)("main",{className:(0,j.cn)("min-w-0 flex-1 transition-[padding] duration-300 ease-out",a?"lg:pl-[72px]":"lg:pl-[280px]"),children:[(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 shrink-0 items-center gap-2 border-b border-[var(--border)] bg-[var(--background)]/95 px-3 backdrop-blur supports-[backdrop-filter]:bg-[var(--background)]/80 sm:h-16 sm:px-4",children:[(0,t.jsx)(P,{}),(0,t.jsx)("div",{className:"flex-1 min-w-0"}),(0,t.jsx)(L,{})]}),(0,t.jsx)("div",{className:"min-w-0 overflow-x-hidden p-4 sm:p-6 lg:p-8",children:r})]})]}):(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,t.jsx)("p",{className:"text-[var(--muted-foreground)]",children:"Redirection..."})})}},14766:(e,r,a)=>{"use strict";a.d(r,{SidebarProvider:()=>l,c:()=>i});var t=a(95155),s=a(12115);let n=s.createContext(null);function l(e){let{children:r}=e,[a,l]=s.useState(!1),[i,d]=s.useState(!1),c=s.useMemo(()=>({mobileOpen:a,setMobileOpen:l,collapsed:i,setCollapsed:d}),[a,i]);return(0,t.jsx)(n.Provider,{value:c,children:r})}function i(){let e=s.useContext(n);if(!e)throw Error("useSidebar must be used within SidebarProvider");return e}},93467:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(67401).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},14081:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(67401).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},27065:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(67401).A)("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]])},40767:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(67401).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},76046:(e,r,a)=>{"use strict";var t=a(66658);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[352,525,173,888,29,441,517,358],()=>r(38867)),_N_E=e.O()}]);